(()=>{var h=class{constructor(t){this.targetNode=t,this.setup(),this.slider=this.initialize(),this.handleEvents(),this.handleMount()}setup(){this.settings=this.getSettings(),this.domNodes=this.getDomNodes(),this.breakpoints=this.getBreakpoints(),this.range=this.getRange(),this.billingPeriod=this.getBillingPeriod(),this.product=this.getProduct()}getSliderSettings(){return{start:this.getStartBreakpoint().percent,range:this.getRange(),connect:"lower",behaviour:"snap"}}getSettings(){let t=$(this.targetNode),n=t.data("maxContact"),e=t.data("maxContactLabel"),i=t.data("maxContactLink"),r=t.data("maxContactTitle"),a=t.data("button");return{maxContact:{enabled:!!parseFloat(n),label:e||"Contact Sales",link:i||"",title:r||"Custom Pricing"},button:a||""}}getDomNodes(){let t={item:".pricing__slider__item",breakpoints:".pricing__slider__breakpoints",price:".pricing__slider__price",priceLabel:".pricing__slider__price__label",priceValue:".pricing__slider__price__value",priceValueAlternate:".pricing__slider__price__value--alternate",count:".pricing__slider__count",countLabel:".pricing__slider__count__label",countValue:".pricing__slider__count__value",rangeMin:".pricing__slider__range--min",rangeMax:".pricing__slider__range--max"};for(let[n,e]of Object.entries(t))t[n]=`${this.targetNode} ${e}`;return t}getBreakpoints(t){let n=$(this.domNodes.breakpoints),e=[];if(t||(t=$(this.targetNode).data("billingPeriod")),n.children().each(function(){let i=t==="yearly"?"priceAnnual":"price",r=$(this).data(i);if(r)r=parseFloat(r);else return;let a=$(this).data("count");if(a)a=parseFloat(a);else return;let o=$(this).data("start");e.push({price:r,count:a,start:!!o})}),e=[...e].sort((i,r)=>i.count-r.count),this.settings.maxContact.enabled){let i=e[e.length-1];e.push({...i,start:!1})}return e=e.map((i,r,a)=>{let o=Math.round(r/(a.length-1)*100);return{...i,percent:o}}),e}getStartBreakpoint(){return this.breakpoints.find(({start:t})=>!!t)||this.breakpoints[0]}getRange(){let t={};return this.breakpoints.forEach(({percent:n})=>{let e=n===0?"min":n===100?"max":`${n}%`;t[`${e}`]=[n]}),t}formatNumberWithCommas(t){let e=Math.round(t).toString().split(".");return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),e.join(".")}formatNumberWithSuffix(t){return t>=1e6?`${t/1e6}M`:t>=1e3?`${t/1e3}K`:t}setCountValue(t,n){let e=$(this.domNodes.countValue),i=this.formatNumberWithCommas(t);n===100&&(i+="+"),e.text(i)}setPriceValue(t,n){let e=$(this.domNodes.priceValue);if(t=this.formatNumberWithCommas(t),n===0)return e.text(`Starts at $${t}/mo`);if(this.settings.maxContact.enabled&&n===100)return e.text(this.settings.maxContact.title);e.text(`$${t}/mo estimated`)}setAlternativePriceValue(t,n){let e=$(this.domNodes.priceValueAlternate);if(this.settings.maxContact.enabled&&n===100)return e.text(" ");let i=this.getBillingPeriod()==="monthly"?"yearly":"monthly",a=this.getBreakpoints(i).find(l=>l.percent===n),o=this.formatNumberWithCommas(a.price);e.text(`$${o}/mo billed ${i==="monthly"?"monthly":"annually"}`)}setRangeLabels(){$(this.domNodes.rangeMin).text(this.formatNumberWithSuffix(this.breakpoints.find(({percent:e})=>e===0).count)),$(this.domNodes.rangeMax).text(`${this.formatNumberWithSuffix(this.breakpoints.find(({percent:e})=>e===100).count)}+`)}getBillingPeriod(){let t=["monthly","yearly"],n=$(this.targetNode).data("billingPeriod");if(!n)return t[0];let e=t.find(i=>i===n.toLowerCase().trim());return e||t[0]}getProduct(){let t=["boss mode","starter"],n=$(this.targetNode).data("product");if(!n)return t[0];let e=t.find(i=>i===n.toLowerCase().trim());return e||t[0]}setButtonParams(t,n){let e=this.settings.button;if(!e)return;let i=$(e);if(!i)return;let r=$(i).attr("href");if(!r)return;let a=$(i).data("href");a||($(i).data("href",r),a=r);let o=$(i).text(),l=i.data("label");l||($(i).data("label",o),l=o);let[b,x]=a.split(/[?#]/),c=new URLSearchParams(x);if(this.settings.maxContact.enabled&&n===100){let d=this.settings.maxContact.link;d!==r&&$(i).attr("href",d),this.settings.maxContact.label!==o&&$(i).text(this.settings.maxContact.label)}else{c.set("volume",t),c.set("product",this.product),c.set("billingPeriod",this.billingPeriod);let d=c.toString(),m=b+"?"+d;$(i).attr("href",m),o!==l&&$(i).text(l)}}getRangeBreakpointIndex(t){let n=this.breakpoints.findIndex(e=>e.percent>t)-1;return t===100?n=this.breakpoints.length-1:n<0&&(n=0),n}handleOnSlide(t){let n=Math.round(t),e=this.getRangeBreakpointIndex(n),i=this.breakpoints[e];return this.setPriceValue(i.price,i.percent),this.setAlternativePriceValue(i.price,i.percent),this.setCountValue(i.count,i.percent),this.setButtonParams(i.count,i.percent),i}handleOnEnd(t){let n=this.handleOnSlide(t);this.slider.set(n.percent)}handleEvents(){this.slider.on("slide",(t,n,[e])=>this.handleOnSlide(e)),this.slider.on("end",(t,n,[e])=>this.handleOnEnd(e))}handleOnBillingPeriodChange(){$(this.targetNode).on("billingPeriodChange",(t,n)=>{let e=["monthly","yearly"],i=n.billingPeriod;i=e.find(a=>a===i)||e[0],$(this.targetNode).data("billingPeriod",i),$(this.targetNode).attr("data-billing-period",i),this.setup(),this.setRangeLabels();let r=parseFloat(this.slider.get());this.slider.updateOptions(this.getSliderSettings(),!1),this.handleOnSlide(r),this.slider.set(r)})}handleMount(){this.handleOnSlide(this.getStartBreakpoint().percent),this.setRangeLabels(),this.handleOnBillingPeriodChange()}initialize(){return noUiSlider.create(document.querySelector(this.domNodes.item),this.getSliderSettings())}},N=()=>{let s=$(".pricing__slider");!s.length||s.each(function(t){let n=`pricing__slider--${t}`;$(this).addClass(n),new h(`.${n}`)})},_=()=>N();var g={container:".pricing__slider__toggle__container",switchButton:".pricing__slider__toggle__switch",selectButton:".pricing__slider__toggle__switch__select"},u={change:"onActiveStateChange"},p="active",k=(s,t)=>{let e=["monthly","yearly"][t?1:0],i=$(s).data("targetSelector");!i||(t?$(s).addClass(p):$(s).removeClass(p),$(i).each(function(){$(this).trigger("billingPeriodChange",{billingPeriod:e})}))},C=()=>{let s=$(g.container);!s.length||s.each(function(){let t=$(this);$(t).children(g.switchButton).each(function(){$(this).on("click",function(){$(t).trigger(u.change,{activeState:$(t).hasClass(p)?0:1})})}),$(t).children(g.selectButton).each(function(){let i=$(this).data("active");i!=null&&$(this).on("click",function(){$(t).trigger(u.change,{activeState:i})})}),$(this).on(u.change,(i,r)=>{let a=parseFloat(r.activeState);k(this,a)})})},f=()=>C();var P=()=>!!window.jQuery;(()=>{let s="Jasper Slider ::";if(!P()){console.error(`${s} Missing required dependency`);return}window.$=window.jQuery,window.JasperPricingSlider={initSlider:_,initToggle:f}})();})();
